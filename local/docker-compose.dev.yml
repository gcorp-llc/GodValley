version: "3.9"

services:
  godvalley-web:
    build:
      context: ../services/godvalley/web
      dockerfile: Dockerfile
    ports:
      - "3000:3000"
    environment:
      NEXT_PUBLIC_API_BASE_URL: http://localhost:8080
    depends_on:
      - godvalley-core

  godvalley-core:
    build:
      context: ..
      dockerfile: services/godvalley/apps/core/Dockerfile
    ports:
      - "8080:8080"
      - "50051:50051"
    environment:
      RUST_LOG: info
      REDIS_HOST: godvalley-redis
      SCYLLA_HOST: godvalley-scylla
    depends_on:
      - godvalley-redis
      - godvalley-scylla

  godvalley-redis:
    image: redis:7.2-alpine
    ports:
      - "6379:6379"
    volumes:
      - godvalley-redis-data:/data

  godvalley-scylla:
    image: scylladb/scylla:6.3
    ports:
      - "9042:9042"
    volumes:
      - godvalley-scylla-data:/var/lib/scylla

  gcorp-web:
    build:
      context: ../services/gcorp.cc/web
      dockerfile: Dockerfile
    ports:
      - "3001:3000"
    environment:
      NEXT_PUBLIC_API_BASE_URL: http://localhost:8081

  gcorp-api:
    build:
      context: ..
      dockerfile: services/gcorp.cc/apps/api/Dockerfile
    ports:
      - "8081:8080"

  journa-web:
    build:
      context: ../services/journa/web
      dockerfile: Dockerfile
    ports:
      - "3002:3000"
    environment:
      NEXT_PUBLIC_API_BASE_URL: http://localhost:8082

  journa-api:
    build:
      context: ..
      dockerfile: services/journa/apps/api/Dockerfile
    ports:
      - "8082:8080"

  cardiani-web:
    build:
      context: ../services/cardiani/web
      dockerfile: Dockerfile
    ports:
      - "3003:3000"
    environment:
      NEXT_PUBLIC_API_BASE_URL: http://localhost:8083

  cardiani-api:
    build:
      context: ..
      dockerfile: services/cardiani/apps/api/Dockerfile
    ports:
      - "8083:8080"

  zeteb-web:
    build:
      context: ../services/zeteb/web
      dockerfile: Dockerfile
    ports:
      - "3004:3000"
    environment:
      NEXT_PUBLIC_API_BASE_URL: http://localhost:8084

  zeteb-api:
    build:
      context: ..
      dockerfile: services/zeteb/apps/api/Dockerfile
    ports:
      - "8084:8080"

volumes:
  godvalley-redis-data:
  godvalley-scylla-data:
